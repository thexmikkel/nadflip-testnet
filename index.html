<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NadFlip - Testnet</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>
    <div class="disclaimer">
    🌟 <strong>Minimum flip amount has been changed to 1 MON for better user experience. Happy flipping! </strong>🌟
    </div>
  <!-- <div class="disclaimer">
    ⚠️ <strong>This is only meant for use on Monad Testnet, and will not continue after mainnet launch.</strong>
  </div> -->
  <canvas id="confetti-canvas" style="position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:999999;"></canvas>
  <div class="arcade-box">
    <div class="header-bar">
      <h1 class="title">NadFlip</h1>
      <div class="wallet-controls">
        <appkit-button />
        <appkit-network-button />
      </div>
    </div>

    <div class="bet-toggle">
      <label class="bet-option">
        <input type="radio" name="betSide" value="win" checked>
        <img src="images/monad-colored.png" alt="Bet on Colored side">
      </label>
      <label class="bet-option">
        <input type="radio" name="betSide" value="loss">
        <img src="images/monad-dark.png" alt="Bet on Dark side">
      </label>
    </div>

    <div class="coin-container">
      <div id="coin" class="coin">
        <div class="side win">
          <img src="images/monad-colored.png" alt="Monad Win" />
          <div class="win-amount" id="winAmount"></div>
        </div>
        <div class="side lose">
          <img src="images/monad-dark.png" alt="Monad Lose" />
          <div class="win-amount" id="lossAmount"></div>
        </div>
      </div>
      <canvas id="confetti-canvas"></canvas>
    </div>

    <div class="input-row">
      <input type="number" id="betAmount" placeholder="Enter MON - Max 30." step="0.001">
      <button id="flipBtn">Flip</button>
    </div>
    <div class="increment-bar">
      <button data-inc="1">+1</button>
      <button data-inc="2.5">+2.5</button>
      <button data-inc="10">+10</button>
      <button data-inc="x2">x2</button>
      <button id="clearAmount">Clear</button>
    </div>
    <div class="pythFee" id="pythFeeText" style="display:none; margin-top: 10px; margin-bottom: 10px; font-size: 0.6rem;"></div>
    <div id="refundNotice" style="display:none; margin-top: 10px;">
      <p style="color: #ff4444;">You have a stuck flip that can be refunded.</p>
      <button id="refundBtn" class="btn btn-warning">Refund</button>
    </div>
    <div class="stats-box" id="myStats">
      <div id="connectShow" style="display:none;">
        <h3>My Stats</h3>
        <ul>
          <li>Flips: <span id="flips">0</span></li>
          <li>Wins: <span id="wins">0</span></li>
          <li>Jackpots: <span id="jackpots">0</span></li>
          <li>Wagered: <span id="wagered">0.0000</span> MON</li>
          <li>Paid Out: <span id="paidOut">0.0000</span> MON</li>
          <li>Net: <span id="netGain">0.0000</span> MON</li>
        </ul>
      </div>
      <div id="jackpotBanner" class="jackpot-banner">
        💎 Jackpot: <span id="jackpotAmount">0.00</span> MON<br>
        <small>🎯 Roll <strong>888</strong> to win the jackpot!</small>
      </div>
    </div>

    <div id="contractBalance" class="contract-balance">
      🏦 Contract Balance: <span id="balanceAmount">0.00</span> MON
    </div>
    <div class="flip-tables-container">
      <div class="stats-box" id="connectShow" style="display:none;">
        <h3>My Recent Flips</h3>
        <table>
          <thead>
            <tr>
              <th>Player</th>
              <th>Guess</th>
              <th>Result</th>
              <th>Rolled</th>
              <th>Result</th>
            </tr>
          </thead>
          <tbody id="myRecentFlips"></tbody>
        </table>
        <div id="myPagination" class="pagination-controls"></div>
      </div>
      <div class="stats-box">
        <h3>Latest Flips</h3>
        <table>
          <thead>
            <tr>
              <th>Player</th>
              <th>Guess</th>
              <th>Result</th>
              <th>Rolled</th>
              <th>Result</th>
            </tr>
          </thead>
          <tbody id="recentFlips"></tbody>
        </table>
        <div id="recentPagination" class="pagination-controls"></div>
      </div>
    </div>

    <div class="faq">
      <h3>FAQ</h3>
      <details>
  <summary>💡 How does NadFlip work?</summary>
  <p>When you place a bet using MON, our smart contract requests a secure random number from the <strong>Pyth Entropy</strong> protocol. The result is used to simulate a coin flip between 1 and 999:</p>
  <ul>
    <li>If you guessed "High" and the roll is 500–999, you win.</li>
    <li>If you guessed "Low" and the roll is 1–499, you win.</li>
    <li>If the roll is exactly <code>888</code>, you win the <strong>entire jackpot pool</strong> on top of your payout.</li>
  </ul>
  <p>Winnings are instantly transferred to your wallet if you win. All flips are stored on-chain and visible in the flip history.</p>
</details>

<details>
  <summary>🔮 What is $MON?</summary>
  <p>MON is the native currency on the <strong>Monad Testnet</strong>. NadFlip is a testnet-only project, meaning all tokens used are free testnet tokens without real-world value.</p>
</details>
        
<details>
  <summary>💎 What happens if I roll 888?</summary>
  <p>888 is the <strong>jackpot number</strong>. If your random roll is exactly 888, you win:</p>
  <ul>
    <li>The regular payout (2x your bet minus fees), <em>plus</em></li>
    <li>The entire <strong>jackpot pool</strong>, which grows every time someone flips.</li>
  </ul>
  <p>After a jackpot win, the pool resets to zero. Previous jackpot wins are logged on-chain and viewable in the Jackpot History.</p>
</details>

<details>
  <summary>❓ Why do I pay a fee?</summary>
  <p>Fees are necessary to maintain the game and fund the jackpot:</p>
  <ul>
    <li><strong>0.2%</strong> goes to the developer wallet (to keep NadFlip running).</li>
    <li><strong>0.8%</strong> goes into the jackpot pool, making it grow over time.</li>
  </ul>
  <p>These percentages are deducted from the bet amount and are only collected if your flip is valid.</p>
</details>

<details>
  <summary>⚙️ What is the extra Pyth Entropy fee?</summary>
  <p>To ensure randomness is <strong>secure and tamper-proof</strong>, NadFlip uses <a href="https://docs.pyth.network/entropy" target="_blank">Pyth Entropy</a>, a decentralized on-chain randomness provider.</p>
  <p>This system requires each flip to pay a small gas fee to the Entropy network’s provider, which is separate from NadFlip. This fee is:</p>
  <ul>
    <li><strong>Quoted live from the Entropy contract</strong> before each flip.</li>
    <li>Automatically included in your transaction total.</li>
    <li>Forwarded to the provider to fulfill randomness via callback.</li>
  </ul>
  <p>The fee is not taken by NadFlip, nor does it affect your payout. However, it is deducted from your total msg.value, so your actual bet amount is <code>msg.value - entropy fee</code>.</p>
</details>
    </div>
    <div class="socials">
      <a href="https://discord.gg/fhreRFCR4T" target="_blank"><img src="discord.svg" alt="Discord" /></a>
      <a href="https://x.com/nadflip888" target="_blank"><img src="twitter.svg" alt="Twitter" /></a>
    </div>
    <footer>
      <a href="https://legal.nadflip.com" class="legal-link">Legals</a>
    </footer>
  </div>
    <script type="module" src="/src/main.js"></script>
    <script type="module" src="arcade.js"></script>
  </body>
</html>
